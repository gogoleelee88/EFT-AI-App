# 기술 구현 계획서

**프로젝트명**: EFT AI 마음챙김 앱  
**개발 기간**: 2025년 8월 15일 ~ 9월 20일 (36일)  
**목표**: AI 임팩트 공모전 출품

---

## 🏗️ 시스템 아키텍처

### **프론트엔드 스택**
```typescript
Core Framework: React 18 + TypeScript + Vite
Styling: Tailwind CSS + Headless UI
State Management: Zustand (경량화)
AI Integration: Transformers.js + Hugging Face
3D Graphics: Three.js + React Three Fiber (EFT 아바타)
PWA: Workbox + Web Push API
```

### **백엔드 스택**
```typescript
Primary: Firebase (MVP 단계)
- Authentication: Firebase Auth
- Database: Firestore (NoSQL)
- Storage: Firebase Storage
- Hosting: Firebase Hosting
- Functions: Firebase Cloud Functions

Future Migration: Supabase (확장 단계)
- Database: PostgreSQL
- Auth: Supabase Auth  
- Storage: Supabase Storage
- Edge Functions: Deno
```

### **AI/ML 스택**
```typescript
Level 1 (규칙 기반):
- 키워드 매칭 알고리즘
- 패턴 인식 로직

Level 2 (Transformers.js):
- Model: "microsoft/DialoGPT-korean"
- Sentiment Analysis: "klue/roberta-base-sentiment"
- Emotion Detection: Custom fine-tuned model

Level 3 (자체 AI - 확장 단계):
- Base Model: GPT-3.5 Turbo
- Fine-tuning: EFT 전문 데이터셋
- Deployment: Vercel AI SDK
```

---

## 🚀 개발 단계별 계획

### **Week 1: 기반 구축** (8/15 ~ 8/21)
```
✅ 프로젝트 셋업 완료
✅ 기본 UI 컴포넌트 완료
✅ 루트 선택 시스템 완료
🔄 진행중: 페이지별 구현
```

#### **구현 목표**
- [x] Vite + React + TypeScript 셋업
- [x] Tailwind CSS 설정
- [x] Firebase 연결
- [x] 기본 UI 컴포넌트 (Button, Card, Input 등)
- [x] 레이아웃 시스템 (Header, BottomNav, Layout)
- [x] 3-루트 선택 컴포넌트
- [ ] 메인 대시보드 페이지
- [ ] 기본 라우팅 설정

### **Week 2: 핵심 기능 구현** (8/22 ~ 8/28)
#### **구현 목표**
- [ ] 감정 체크인 페이지 (루트 2)
- [ ] EFT 세션 가이드 페이지  
- [ ] AI 동반자 채팅 인터페이스 (루트 1)
- [ ] 확언 EFT 페이지 (루트 3)
- [ ] Firebase 데이터 구조 설계
- [ ] 사용자 인증 시스템

### **Week 3: AI 시스템 구축** (8/29 ~ 9/4)
#### **구현 목표**
- [ ] 3단계 하이브리드 AI 시스템 구현
- [ ] Transformers.js 통합
- [ ] 감정 분석 AI 모델 연동
- [ ] 개인화 알고리즘 기초 버전
- [ ] 대화 히스토리 저장/분석

### **Week 4: 고도화 및 통합** (9/5 ~ 9/11)
#### **구현 목표**
- [ ] 3D EFT 아바타 가이드 (Three.js)
- [ ] 개인화 AI 학습 시스템
- [ ] 실시간 효과 측정
- [ ] PWA 기능 구현
- [ ] 성능 최적화

### **Week 5: 완성 및 테스트** (9/12 ~ 9/18)
#### **구현 목표**
- [ ] 전체 시스템 통합 테스트
- [ ] 사용자 경험 최적화
- [ ] 버그 수정 및 안정화
- [ ] 데이터 분석 대시보드
- [ ] 배포 환경 구성

### **Final Week: 출품 준비** (9/19 ~ 9/20)
#### **구현 목표**
- [ ] 최종 테스트 및 QA
- [ ] 공모전 제출 자료 준비
- [ ] 데모 영상 제작
- [ ] 발표 자료 완성

---

## 🚀 MVP 이후 다음 단계 계획: AI 예측 케어 시스템

### **Phase 2: 스마트 예측 케어 고려사항** (MVP 이후 개발 검토)

#### **AI 예측 케어가 의미있으려면 필요한 요소들**

**📊 AI 케어를 위한 데이터:**
- **몇 주간의 패턴 데이터**: 최소 8-12주 감정 변화 추적 필요
- **실시간 상황 인식**: 마이크로 "내일 발표" 같은 키워드 감지
- **캘린더 연동**: 일정 분석으로 스트레스 상황 예측
- **위치/시간 패턴 분석**: 장소별, 시간대별 감정 패턴 추적
- **최소 50-100회 이상 대화 데이터**: 개인화 AI 학습용 대화 기록

```typescript
const predictiveCareRequirements = {
  // 최소 데이터 축적 기간
  dataCollection: {
    emotionalPatterns: "최소 8-12주간의 사용자 감정 패턴 데이터",
    conversationHistory: "최소 50-100회 이상의 AI 대화 기록",
    timeBasedPatterns: "시간대별, 요일별 감정 변화 추적",
    locationPatterns: "위치별 스트레스 패턴 분석",
    triggerEvents: "개인별 스트레스 유발 상황 패턴 분석"
  },
  
  // 실시간 상황 인식 기술
  contextualAwareness: {
    calendarIntegration: "Google Calendar 일정 분석으로 스트레스 상황 예측",
    conversationAnalysis: "마이크로 '내일 발표', '면접' 등 키워드 실시간 감지",
    voiceEmotionDetection: "음성 톤 변화로 감정 상태 실시간 분석",
    backgroundMonitoring: "24시간 감정 패턴 모니터링 시스템",
    locationAwareness: "GPS 기반 위치별 감정 패턴 추적"
  },
  
  // 고급 예측 엔진
  predictionEngine: {
    timeSeriesAnalysis: "개인별 감정 주기 예측 모델",
    machineLearning: "사용자 맞춤 스트레스 예측 알고리즘",
    contextualAI: "상황 인식 기반 최적 개입 시점 결정",
    patternRecognition: "복합적 상황 패턴 인식 및 예측"
  }
};
```

#### **기술적 구현 가능성 분석**

**✅ 구현 가능한 기술들:**
- **시간 패턴 분석**: 규칙적 스트레스 패턴 감지 및 예측
- **대화 키워드 분석**: 텍스트에서 스트레스 유발 요인 자동 감지
- **캘린더 연동**: Google Calendar API를 통한 일정 기반 예측
- **음성 감정 분석**: Web Speech API + 감정 분석 AI 모델
- **24시간 백그라운드 모니터링**: PWA Service Worker 활용

**⚠️ 고려해야 할 기술적 과제들:**
- **배터리 최적화**: 연속 음성 분석 시 전력 소모 관리
- **프라이버시 보호**: 음성 데이터 로컬 처리 및 암호화
- **실시간 처리**: 즉시 반응 가능한 경량 AI 모델 구축
- **정확도 향상**: 개인화된 예측 모델 학습 시간 단축

#### **단계별 구현 로드맵**

**Phase 2A: 기본 예측 시스템** (3-4개월)
- 시간대/요일별 감정 패턴 분석
- 대화 키워드 기반 스트레스 예측
- Google Calendar 연동 일정 분석
- 기본 알림 시스템 구축

**Phase 2B: 음성 분석 시스템** (2-3개월)  
- 실시간 음성 감정 상태 분석
- 백그라운드 모니터링 시스템
- 즉시 개입 알고리즘 구현
- 개인화 예측 모델 고도화

**Phase 2C: 고급 AI 시스템** (3-4개월)
- 멀티모달 데이터 통합 분석
- 머신러닝 기반 예측 정확도 향상
- 자동 EFT 세션 추천 시스템
- 완전 개인화 케어 시스템

#### **예상 성능 지표**
- **예측 정확도**: 70-80% (데이터 축적 후)
- **개입 적절성**: 75%+ (사용자 만족도 기준)
- **배터리 효율**: 일일 5% 이하 추가 소모
- **프라이버시**: 모든 민감 데이터 로컬 처리

---

## 🤖 AI 시스템 구현 상세

### **Level 1: 규칙 기반 시스템**
```typescript
class RuleBasedAI {
  // 즉시 응답 패턴
  quickResponses = {
    greetings: ["안녕하세요", "반가워요", "처음이에요"],
    gratitude: ["고마워요", "감사해요", "도움됐어요"],
    farewell: ["안녕", "나중에", "종료"]
  };

  // 감정 키워드 매핑
  emotionKeywords = {
    stress: ["스트레스", "압박", "부담", "힘들어"],
    anxiety: ["불안", "걱정", "두려워", "긴장"],
    anger: ["화나", "짜증", "억울", "열받아"]
  };
}
```

### **Level 2: Transformers.js 구현**
```typescript
import { pipeline } from '@huggingface/transformers';

class TransformersAI {
  private textGenerator: any;
  private sentimentAnalyzer: any;

  async initialize() {
    this.textGenerator = await pipeline(
      'text-generation',
      'microsoft/DialoGPT-korean'
    );
    
    this.sentimentAnalyzer = await pipeline(
      'sentiment-analysis',
      'klue/roberta-base-sentiment'
    );
  }

  async generateEmpathicResponse(userInput: string): Promise<string> {
    const sentiment = await this.analyzeSentiment(userInput);
    const context = this.buildEmpathicContext(sentiment);
    
    return await this.textGenerator(context + userInput, {
      max_length: 150,
      temperature: 0.7,
      do_sample: true
    });
  }
}
```

### **Level 3: 개인화 AI (확장 단계)**
```typescript
class PersonalizedAI {
  async generatePersonalizedInsight(
    userProfile: UserProfile,
    conversationHistory: Message[]
  ): Promise<PersonalInsight> {
    
    // 개인 패턴 분석
    const patterns = this.analyzePersonalPatterns(
      userProfile, 
      conversationHistory
    );
    
    // 맞춤형 통찰 생성
    return await this.generateCustomInsight(patterns);
  }
}
```

---

## 📊 데이터 구조 설계

### **Firebase Firestore 구조**
```typescript
// Users Collection
users/{userId} {
  profile: {
    email: string;
    displayName: string;
    createdAt: timestamp;
    preferences: UserPreferences;
  };
  
  // 개인화 데이터
  aiProfile: {
    personalityTraits: PersonalityTraits;
    emotionalPatterns: EmotionalPattern[];
    eftPreferences: EFTPreference[];
    communicationStyle: CommunicationStyle;
  };
}

// Sessions Collection  
sessions/{sessionId} {
  userId: string;
  route: 'conversation' | 'checkin' | 'affirmation';
  startTime: timestamp;
  endTime: timestamp;
  
  data: {
    userInputs: string[];
    aiResponses: string[];
    emotionsBefore: EmotionState;
    emotionsAfter: EmotionState;
    eftPointsUsed: number[];
    effectivenessRating: number;
  };
  
  analysis: {
    patterns: string[];
    insights: string[];
    improvements: number;
  };
}
```

---

## 🎨 UI/UX 구현 계획

### **디자인 시스템**
```typescript
// 색상 체계 (임시 - 피그마 완성 후 교체)
const colorScheme = {
  primary: {
    50: '#eff6ff',
    500: '#3b82f6', 
    900: '#1e3a8a'
  },
  
  emotion: {
    calm: '#4ecdc4',
    stress: '#ff6b6b',
    happy: '#ffe66d',
    sad: '#4d96ff'
  }
};

// 반응형 브레이크포인트
const breakpoints = {
  mobile: '320px',
  tablet: '768px', 
  desktop: '1024px'
};
```

### **컴포넌트 아키텍처**
```
src/components/
├── ui/              # 기본 UI 컴포넌트
├── layout/          # 레이아웃 컴포넌트  
├── feature/         # 기능별 컴포넌트
└── eft/            # EFT 전용 컴포넌트
```

---

## ⚡ 성능 최적화 전략

### **프론트엔드 최적화**
```typescript
// 코드 스플리팅
const ChatPage = lazy(() => import('./pages/ChatPage'));
const EFTSession = lazy(() => import('./pages/EFTSession'));

// AI 모델 캐싱
const modelCache = new Map();
const loadModel = async (modelName: string) => {
  if (!modelCache.has(modelName)) {
    const model = await pipeline('text-generation', modelName);
    modelCache.set(modelName, model);
  }
  return modelCache.get(modelName);
};
```

### **데이터 최적화**
```typescript
// 실시간 데이터 동기화
const useRealtimeData = (query: Query) => {
  const [data, setData] = useState();
  
  useEffect(() => {
    return onSnapshot(query, (snapshot) => {
      setData(snapshot.docs.map(doc => doc.data()));
    });
  }, []);
  
  return data;
};
```

---

## 🔒 보안 및 프라이버시

### **데이터 보호**
```typescript
// 클라이언트 사이드 암호화
const encryptSensitiveData = (data: any) => {
  return AES.encrypt(JSON.stringify(data), userKey).toString();
};

// 익명화 처리
const anonymizeUserData = (userData: any) => {
  return {
    ...userData,
    userId: hashUserId(userData.userId),
    personalInfo: '[REDACTED]'
  };
};
```

### **Firebase 보안 규칙**
```javascript
// Firestore Security Rules
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read, write: if request.auth != null 
        && request.auth.uid == userId;
    }
    
    match /sessions/{sessionId} {
      allow read, write: if request.auth != null 
        && resource.data.userId == request.auth.uid;
    }
  }
}
```

---

## 📱 PWA 구현

### **Service Worker**
```typescript
// 오프라인 지원
self.addEventListener('fetch', (event) => {
  if (event.request.url.includes('/api/ai')) {
    event.respondWith(
      caches.match(event.request)
        .then(response => response || fetch(event.request))
    );
  }
});

// 백그라운드 동기화
self.addEventListener('sync', (event) => {
  if (event.tag === 'eft-session-sync') {
    event.waitUntil(syncEFTSessions());
  }
});
```

---

## 📈 분석 및 모니터링

### **사용자 행동 분석**
```typescript
// 익명화된 사용 패턴 수집
const trackUserBehavior = (event: AnalyticsEvent) => {
  analytics.track({
    event: event.name,
    properties: anonymize(event.properties),
    timestamp: Date.now()
  });
};
```

### **AI 성능 모니터링**
```typescript
// AI 응답 품질 추적
const monitorAIResponse = (response: AIResponse) => {
  metrics.record({
    responseTime: response.duration,
    confidence: response.confidence,
    userSatisfaction: response.rating
  });
};
```

---

## 🎯 성공 지표

### **기술적 지표**
- AI 응답 시간: < 2초
- 앱 로딩 시간: < 3초  
- 오프라인 동작률: 90%+
- 크래시 없는 세션: 99%+

### **사용자 지표**  
- 감정 개선도: 평균 30%+
- 세션 완료율: 80%+
- 재사용률: 60%+ (7일 내)
- 사용자 만족도: 4.5/5+

### **AI 지표**
- 감정 인식 정확도: 85%+
- 개인화 적중률: 70%+
- 예측 케어 성공률: 60%+

---

## 🔮 다음 개발 예정: AI 예측 케어

### **AI 예측 케어란?**
사용자의 감정 패턴을 학습하여 스트레스가 발생하기 **전에** 미리 알림을 보내고 적절한 EFT 세션을 추천하는 시스템

### **🤖 주요 기능들**

#### **1. 선제적 스트레스 예측**
- "매주 화요일 오후 3시에 스트레스 패턴" 감지 → 사전 알림
- "내일 발표" 키워드 감지 → 발표 불안 완화 EFT 자동 추천
- 캘린더 일정 분석 → 중요 회의 전 미리 준비 세션 제안

#### **2. 실시간 감정 모니터링**
- 음성 톤 변화로 스트레스 상태 실시간 감지
- 24시간 백그라운드에서 감정 패턴 추적
- 즉시 개입이 필요한 순간 자동 감지

#### **3. 개인화 예측 엔진**
- 개인별 감정 주기 학습 (8-12주 데이터 기반)
- 50-100회 대화 분석으로 맞춤형 케어 제공
- 위치별, 시간대별 스트레스 패턴 분석

#### **4. 상황 인식 AI**
- Google Calendar 연동으로 일정 기반 예측
- GPS 위치 정보로 장소별 감정 패턴 추적
- 복합적 상황 분석으로 정확한 예측 제공

### **💡 예측 케어 예시**
```
🔮 AI 예측: "오늘 오후 3시경 스트레스가 올 수 있어요"
📅 근거: 지난 3주간 화요일 오후 패턴 + 내일 발표 일정
💊 제안: "지금 5분 호흡 EFT로 미리 준비해볼까요?"
```

### **📊 예상 효과**
- **스트레스 예방률**: 70% 이상
- **사용자 만족도**: 90% 이상 
- **앱 사용 시간**: 기존 5분 → 20분으로 증가
- **리텐션**: 45% → 85%로 대폭 상승

---

**🚀 이 계획으로 AI 임팩트 공모전 우승을 목표합니다!**